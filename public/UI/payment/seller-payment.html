<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Become a Seller - Payment</title>
<link rel="stylesheet" href="/css/standardLayout.css">
<link rel="stylesheet" href="/css/footer/footer.css">
<link rel="stylesheet" href="/css/become-a-seller/payment.css">
</head>

<body>
  <div class="navbar">
    <div class="logo">
      <img src="/images/fruiti.png" alt="Fruiti Logo" />
    </div>
    <div class="search-bar">
      <input type="text" placeholder="Search Fruit" />
    </div>
    <div class="auth-buttons" id="authButtons">
      <button class="login-btn" onclick="location.href='/login'">Log In</button>
      <button class="signup-btn" onclick="location.href='/signup'">Sign Up</button>
    </div>
  </div>

  <nav class="nav-links">
    <a href="/">Home</a>
    <a href="/become-seller" class="active">Become a Seller</a>
    <a href="/nutrition">Nutrition</a>
    <a href="/recipe.html">Recipes</a>
    <a href="/aboutus">About Us</a>
  </nav>

  <div class="black-bar"></div>

  <div class="payment-container">
    <!-- Left Side - Payment Form -->
    <div class="payment-section">
      <h2 class="section-title">Complete Your Purchase</h2>
      
      <!-- Account Status Notice -->
      <div class="account-notice" id="accountNotice">
        <p><strong>New to Fruiti?</strong> Create your account and become a seller in one step!</p>
      </div>

      <form id="paymentForm">
        <!-- Account Information (only for non-logged in users) -->
        <div id="accountSection">
          <div class="form-group">
            <label for="email">Email Address *</label>
            <input type="email" id="email" name="email" required>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label for="password">Password *</label>
              <input type="password" id="password" name="password" required>
            </div>
            <div class="form-group">
              <label for="confirmPassword">Confirm Password *</label>
              <input type="password" id="confirmPassword" name="confirmPassword" required>
            </div>
          </div>
        </div>

        <!-- Stand Information -->
        <h3 style="color: #017d49; font-size: 20px; margin: 32px 0 16px;">Stand Information</h3>
        
        <div class="form-group">
          <label for="standName">Stand Name *</label>
          <input type="text" id="standName" name="standName" placeholder="e.g., Johnson's Fresh Fruit Stand" required>
        </div>

        <div class="form-group">
          <label for="standDescription">Stand Description</label>
          <textarea id="standDescription" name="standDescription" rows="3" placeholder="Tell customers about your stand..."></textarea>
        </div>

        <div class="form-group">
          <label for="phone">Phone Number *</label>
          <input type="tel" id="phone" name="phone" required>
        </div>

        <div class="form-group">
          <label for="standAddress">Stand Address *</label>
          <input type="text" id="standAddress" name="standAddress" placeholder="Street address" required>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="city">City *</label>
            <input type="text" id="city" name="city" required>
          </div>
          <div class="form-group">
            <label for="state">State *</label>
            <select id="state" name="state" required>
              <option value="">Select a state</option>
              <option value="Alabama">Alabama</option>
              <option value="Alaska">Alaska</option>
              <option value="Arizona">Arizona</option>
              <option value="Arkansas">Arkansas</option>
              <option value="California">California</option>
              <option value="Colorado">Colorado</option>
              <option value="Connecticut">Connecticut</option>
              <option value="Delaware">Delaware</option>
              <option value="Florida">Florida</option>
              <option value="Georgia">Georgia</option>
              <option value="Hawaii">Hawaii</option>
              <option value="Idaho">Idaho</option>
              <option value="Illinois">Illinois</option>
              <option value="Indiana">Indiana</option>
              <option value="Iowa">Iowa</option>
              <option value="Kansas">Kansas</option>
              <option value="Kentucky">Kentucky</option>
              <option value="Louisiana">Louisiana</option>
              <option value="Maine">Maine</option>
              <option value="Maryland">Maryland</option>
              <option value="Massachusetts">Massachusetts</option>
              <option value="Michigan">Michigan</option>
              <option value="Minnesota">Minnesota</option>
              <option value="Mississippi">Mississippi</option>
              <option value="Missouri">Missouri</option>
              <option value="Montana">Montana</option>
              <option value="Nebraska">Nebraska</option>
              <option value="Nevada">Nevada</option>
              <option value="New Hampshire">New Hampshire</option>
              <option value="New Jersey">New Jersey</option>
              <option value="New Mexico">New Mexico</option>
              <option value="New York">New York</option>
              <option value="North Carolina">North Carolina</option>
              <option value="North Dakota">North Dakota</option>
              <option value="Ohio">Ohio</option>
              <option value="Oklahoma">Oklahoma</option>
              <option value="Oregon">Oregon</option>
              <option value="Pennsylvania">Pennsylvania</option>
              <option value="Rhode Island">Rhode Island</option>
              <option value="South Carolina">South Carolina</option>
              <option value="South Dakota">South Dakota</option>
              <option value="Tennessee">Tennessee</option>
              <option value="Texas">Texas</option>
              <option value="Utah">Utah</option>
              <option value="Vermont">Vermont</option>
              <option value="Virginia">Virginia</option>
              <option value="Washington">Washington</option>
              <option value="West Virginia">West Virginia</option>
              <option value="Wisconsin">Wisconsin</option>
              <option value="Wyoming">Wyoming</option>
            </select>
          </div>
        </div>

        <div class="form-group">
          <label for="zipcode">ZIP Code *</label>
          <input type="text" id="zipcode" name="zipcode" placeholder="12345" maxlength="5" required>
        </div>

        <!-- Payment Information -->
        <h3 style="color: #017d49; font-size: 20px; margin: 32px 0 16px;">Payment Information</h3>

        <div class="payment-methods">
          <div class="payment-method active" data-method="card">
            <div class="card-icons">üí≥</div>
            <div>Credit Card</div>
          </div>
          <div class="payment-method" data-method="paypal">
            <div class="card-icons">üÖøÔ∏è</div>
            <div>PayPal</div>
          </div>
        </div>

        <div id="cardPaymentSection">
          <div class="form-group">
            <label for="cardNumber">Card Number *</label>
            <input type="text" id="cardNumber" name="cardNumber" placeholder="1234 5678 9012 3456" maxlength="19" required>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label for="cardName">Name on Card *</label>
              <input type="text" id="cardName" name="cardName" required>
            </div>
            <div class="form-group">
              <label for="expiryDate">Expiry Date *</label>
              <input type="text" id="expiryDate" name="expiryDate" placeholder="MM/YY" maxlength="5" required>
            </div>
          </div>

          <div class="form-group">
            <label for="cvv">CVV *</label>
            <input type="text" id="cvv" name="cvv" placeholder="123" maxlength="4" required>
          </div>
        </div>

        <div class="terms-checkbox">
          <input type="checkbox" id="terms" name="terms" required>
          <label for="terms">
            I agree to the <a href="/terms">Terms of Service</a> and <a href="/privacy">Privacy Policy</a>. 
            I understand my subscription will auto-renew and I can cancel anytime.
          </label>
        </div>

        <button type="submit" class="submit-btn">Complete Purchase & Become a Seller</button>
        
        <p class="security-notice">Your payment information is secure and encrypted by Stripe!</p>
      </form>
    </div>

    <!-- Right Side - Order Summary -->
    <div class="payment-section">
      <h2 class="section-title">Order Summary</h2>
      
      <div class="order-summary">
        <div class="plan-details">
          <div>
            <div class="plan-name-display" id="selectedPlanName">3 Months Plan</div>
            <div class="savings-display" id="savingsDisplay">üí∞ Save 33%</div>
          </div>
          <div class="plan-price-display" id="selectedPlanPrice">$10</div>
        </div>
        
        <div class="features-summary">
          <h4>What's Included:</h4>
          <ul id="planFeaturesList">
            <li>Everything in Monthly</li>
            <li>Priority customer support</li>
            <li>Featured stand placement</li>
            <li>Advanced analytics</li>
            <li>Photo gallery (up to 10 photos)</li>
            <li>Social media integration</li>
          </ul>
        </div>
      </div>

      <div class="total-section">
        <div class="total-row">
          <span>Subtotal</span>
          <span id="subtotal">$10.00</span>
        </div>
        <div class="total-row">
          <span>Tax</span>
          <span id="tax">$0.00</span>
        </div>
        <div class="total-row final">
          <span>Total</span>
          <span id="total">$10.00</span>
        </div>
      </div>
    </div>
  </div>

  <div id="footer-placeholder"></div>
  <script src="/scripts/footer.js"></script>
  <script src="/scripts/navigationForLoggedInUser.js"></script>

  <script>
    // Get plan details from URL parameters
    const urlParams = new URLSearchParams(window.location.search);
    const plan = urlParams.get('plan') || '3month';

    const plans = {
      'monthly': {
        name: 'Monthly Plan',
        price: '$4.99',
        period: '/mo',
        savings: null,
        features: [
          'List your fruit stand location',
          'Update inventory daily',
          'Customer reviews & ratings',
          'Basic analytics dashboard',
          'Email support'
        ],
        amount: 4.99
      },
      '3month': {
        name: '3 Months Plan',
        price: '$10',
        period: '/3mo',
        savings: 'üí∞ Save 33%',
        features: [
          'Everything in Monthly',
          'Priority customer support',
          'Featured stand placement',
          'Advanced analytics',
          'Photo gallery (up to 10 photos)',
          'Social media integration'
        ],
        amount: 10.00
      },
      '6month': {
        name: '6 Months Plan',
        price: '$15',
        period: '/6mo',
        savings: 'üéâ Save 50%',
        features: [
          'Everything in 3 Months',
          'Premium stand badge',
          'Unlimited photos',
          'Custom stand URL',
          'Priority listing in searches',
          'Dedicated account manager',
          'Promotional campaigns'
        ],
        amount: 15.00
      }
    };

    const selectedPlan = plans[plan];

    // Update UI with selected plan
    document.getElementById('selectedPlanName').textContent = selectedPlan.name;
    document.getElementById('selectedPlanPrice').textContent = selectedPlan.price;
    
    if (selectedPlan.savings) {
      document.getElementById('savingsDisplay').textContent = selectedPlan.savings;
      document.getElementById('savingsDisplay').style.display = 'inline-block';
    } else {
      document.getElementById('savingsDisplay').style.display = 'none';
    }

    // Update features list
    const featuresList = document.getElementById('planFeaturesList');
    featuresList.innerHTML = selectedPlan.features.map(feature => `<li>${feature}</li>`).join('');

    // Update totals
    const subtotal = selectedPlan.amount;
    const tax = 0; // You can calculate tax based on location
    const total = subtotal + tax;

    document.getElementById('subtotal').textContent = `$${subtotal.toFixed(2)}`;
    document.getElementById('tax').textContent = `$${tax.toFixed(2)}`;
    document.getElementById('total').textContent = `$${total.toFixed(2)}`;

    // Check if user is logged in
    // This should be replaced with actual authentication check
    const isLoggedIn = false; // Set this based on your auth system

    if (isLoggedIn) {
      document.getElementById('accountSection').style.display = 'none';
      document.getElementById('accountNotice').innerHTML = '<p><strong>Upgrade to Seller Account</strong> Complete your payment to start selling!</p>';
    }

    // Payment method toggle
    document.querySelectorAll('.payment-method').forEach(method => {
      method.addEventListener('click', function() {
        document.querySelectorAll('.payment-method').forEach(m => m.classList.remove('active'));
        this.classList.add('active');
        
        const selectedMethod = this.dataset.method;
        if (selectedMethod === 'paypal') {
          document.getElementById('cardPaymentSection').style.display = 'none';
        } else {
          document.getElementById('cardPaymentSection').style.display = 'block';
        }
      });
    });

    // Card number formatting
    document.getElementById('cardNumber').addEventListener('input', function(e) {
      let value = e.target.value.replace(/\s/g, '');
      let formattedValue = value.match(/.{1,4}/g)?.join(' ') || value;
      e.target.value = formattedValue;
    });

    // Expiry date formatting
    document.getElementById('expiryDate').addEventListener('input', function(e) {
      let value = e.target.value.replace(/\D/g, '');
      if (value.length >= 2) {
        value = value.slice(0, 2) + '/' + value.slice(2, 4);
      }
      e.target.value = value;
    });

    // ZIP code formatting (numbers only)
    document.getElementById('zipcode').addEventListener('input', function(e) {
      e.target.value = e.target.value.replace(/\D/g, '');
    });

    // Form submission
    document.getElementById('paymentForm').addEventListener('submit', function(e) {
      e.preventDefault();
      
      // Validate passwords match if account section is visible
      if (document.getElementById('accountSection').style.display !== 'none') {
        const password = document.getElementById('password').value;
        const confirmPassword = document.getElementById('confirmPassword').value;
        
        if (password !== confirmPassword) {
          alert('Passwords do not match!');
          return;
        }
      }

      // Validate state is selected
      const state = document.getElementById('state').value;
      if (!state) {
        alert('Please select a state');
        return;
      }

      // Validate ZIP code
      const zipcode = document.getElementById('zipcode').value;
      if (zipcode.length !== 5) {
        alert('Please enter a valid 5-digit ZIP code');
        return;
      }

      // Here you would process the payment and create the seller account
      // For now, just show a success message
      alert('Processing your payment...\n\nIn production, this would:\n1. Process payment\n2. Create/upgrade account to seller\n3. Set up your fruit stand\n4. Redirect to seller dashboard');
      
      // Redirect to seller dashboard
      // window.location.href = '/seller/dashboard';
    });
  </script>
</body>
</html>